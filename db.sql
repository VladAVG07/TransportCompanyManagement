-- Stergere tabele initial

DROP TABLE CLIENT_CURSA CASCADE CONSTRAINTS;
DROP TABLE SOFER_VEHICUL CASCADE CONSTRAINTS;
DROP TABLE TRANSPORT_PERSOANE CASCADE CONSTRAINTS;
DROP TABLE TRANSPORT_MARFA CASCADE CONSTRAINTS;
DROP TABLE CURSA CASCADE CONSTRAINTS;
DROP TABLE ALIMENTARE CASCADE CONSTRAINTS;
DROP TABLE ACCIDENT CASCADE CONSTRAINTS;
DROP TABLE MENTENANTA CASCADE CONSTRAINTS;
DROP TABLE CLIENT CASCADE CONSTRAINTS;
DROP TABLE TIR CASCADE CONSTRAINTS;
DROP TABLE AUTOCAR CASCADE CONSTRAINTS;
DROP TABLE VEHICUL CASCADE CONSTRAINTS;
DROP TABLE SOFER CASCADE CONSTRAINTS;

-- Creare tabele

CREATE TABLE SOFER
(
    SOFER_ID      NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NUME          VARCHAR2(50) NOT NULL,
    PRENUME       VARCHAR2(50) NOT NULL,
    DATA_NASTERE  DATE         NOT NULL,
    DATA_ANGAJARE DATE         NOT NULL,
    SALARIU       NUMBER(8, 2) NOT NULL
);

CREATE TABLE VEHICUL
(
    VEHICUL_ID          NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    MARCA               VARCHAR2(50) NOT NULL,
    MODEL               VARCHAR2(50) NOT NULL,
    NR_KILOMETRI        INTEGER      NOT NULL,
    AN_FABRICATIE       INTEGER      NOT NULL,
    CAPACITATE_REZERVOR INTEGER      NOT NULL
);

CREATE TABLE AUTOCAR
(
    VEHICUL_ID     NUMBER PRIMARY KEY,
    NR_LOCURI      INTEGER       NOT NULL,
    SPARTIU_BAGAJE NUMBER(5, 2)  NOT NULL,
    DOTARI         VARCHAR2(200) NOT NULL,
    FOREIGN KEY (VEHICUL_ID) REFERENCES VEHICUL (VEHICUL_ID) ON DELETE CASCADE
);

CREATE TABLE TIR
(
    VEHICUL_ID            NUMBER PRIMARY KEY,
    CAPACITATE_CILINDRICA INTEGER      NOT NULL,
    GREUTATE_MAXIMA       NUMBER(5, 2) NOT NULL,
    TIP_TRACTIUNE         VARCHAR2(4)  NOT NULL,
    NR_AXE                INTEGER      NOT NULL,
    FOREIGN KEY (VEHICUL_ID) REFERENCES VEHICUL (VEHICUL_ID) ON DELETE CASCADE
);

CREATE TABLE CLIENT
(
    CLIENT_ID  NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NUME       VARCHAR2(50)  NOT NULL,
    DESCRIERE  VARCHAR2(100) NOT NULL,
    TIP_CLIENT VARCHAR2(50)  NOT NULL,
    NR_TELEFON VARCHAR(10)   NOT NULL,
    EMAIL      VARCHAR2(100) NOT NULL UNIQUE,
    JUDET      VARCHAR2(50)  NOT NULL,
    ORAS       VARCHAR2(50)  NOT NULL
);

CREATE TABLE MENTENANTA
(
    MENTENANTA_ID  NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    VEHICUL_ID     NUMBER        NOT NULL,
    TIP_MENTENANTA VARCHAR2(50)  NOT NULL,
    DESCRIERE      VARCHAR2(100) NOT NULL,
    COST           NUMBER(14, 4) NOT NULL,
    DATA_ORA_START TIMESTAMP     NOT NULL,
    DATA_ORA_END   TIMESTAMP     NOT NULL,
    FOREIGN KEY (VEHICUL_ID) REFERENCES VEHICUL (VEHICUL_ID) ON DELETE CASCADE
);

CREATE TABLE ACCIDENT
(
    ACCIDENT_ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    VEHICUL_ID  NUMBER        NOT NULL,
    DESCRIERE   VARCHAR2(100) NOT NULL,
    COST_DAUNE  NUMBER(14, 4) NOT NULL,
    DATA_ORA    TIMESTAMP     NOT NULL,
    LOC         VARCHAR2(50)  NOT NULL,
    GRAVITATE   VARCHAR2(20)  NOT NULL,
    AMIABIL     NUMBER(1)     DEFAULT 0 NOT NULL CHECK (AMIABIL IN (0, 1)), -- 0=NU, 1=DA
    FOREIGN KEY (VEHICUL_ID) REFERENCES VEHICUL (VEHICUL_ID) ON DELETE CASCADE
);

CREATE TABLE ALIMENTARE
(
    ALIMENTARE_ID        NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    VEHICUL_ID           NUMBER        NOT NULL,
    LOC_ALIMENTARE       VARCHAR2(50)  NOT NULL,
    TIP_COMBUSTIBIL      VARCHAR2(20)  NOT NULL,
    CANTIATE_COMBUSTIBIL NUMBER(6, 2)  NOT NULL,
    DATA_ORA_ALIMENTARE  TIMESTAMP     NOT NULL,
    COST                 NUMBER(14, 4) NOT NULL,
    BENZINARIE           VARCHAR2(20)  NOT NULL,
    FOREIGN KEY (VEHICUL_ID) REFERENCES VEHICUL (VEHICUL_ID) ON DELETE CASCADE
);

CREATE TABLE CURSA
(
    CURSA_ID         NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    VEHICUL_ID       NUMBER,
    LOC_PLECARE      VARCHAR2(100) NOT NULL,
    LOC_SOSIRE       VARCHAR2(100) NOT NULL,
    DATA_ORA_PLECARE TIMESTAMP     NOT NULL,
    DATA_ORA_SOSIRE  TIMESTAMP,
    COST_TOTAL       NUMBER(14, 4) NOT NULL,
    FOREIGN KEY (VEHICUL_ID) REFERENCES VEHICUL (VEHICUL_ID) ON DELETE SET NULL
);

CREATE TABLE TRANSPORT_MARFA
(
    CURSA_ID          NUMBER PRIMARY KEY,
    TIP_MARFA         VARCHAR2(50)  NOT NULL,
    GREUTATE_MARFA    NUMBER(7, 2)  NOT NULL,
    VOLUM_MARFA       NUMBER(7, 2)  NOT NULL,
    CONDITII_SPECIALE VARCHAR2(100),
    ASIGURARE_MARFA   NUMBER(14, 4) NOT NULL,
    FOREIGN KEY (CURSA_ID) REFERENCES CURSA (CURSA_ID) ON DELETE CASCADE
);

CREATE TABLE TRANSPORT_PERSOANE
(
    CURSA_ID      NUMBER PRIMARY KEY,
    NR_PASAGERI   INTEGER   NOT NULL,
    GHID_TURISTIC NUMBER(1) DEFAULT 0 NOT NULL CHECK (GHID_TURISTIC IN (0, 1)),
    FOREIGN KEY (CURSA_ID) REFERENCES CURSA (CURSA_ID) ON DELETE CASCADE
);

CREATE TABLE SOFER_VEHICUL
(
    SOFER_VEHICUL_ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    VEHICUL_ID       NUMBER,
    SOFER_ID         NUMBER,
    DATA_ORA_START   TIMESTAMP NOT NULL,
    DATA_ORA_END     TIMESTAMP,
    FOREIGN KEY (VEHICUL_ID) REFERENCES VEHICUL (VEHICUL_ID) ON DELETE SET NULL,
    FOREIGN KEY (SOFER_ID) REFERENCES SOFER (SOFER_ID) ON DELETE SET NULL
);

CREATE TABLE CLIENT_CURSA
(
    CLIENT_ID NUMBER,
    CURSA_ID  NUMBER,
    FOREIGN KEY (CLIENT_ID) REFERENCES CLIENT (CLIENT_ID) ON DELETE CASCADE,
    FOREIGN KEY (CURSA_ID) REFERENCES CURSA (CURSA_ID) ON DELETE CASCADE,
    CONSTRAINT PK_CLIENT_CURSA PRIMARY KEY (CLIENT_ID, CURSA_ID)
);

-- Inserturi

-- Inserturi SOFER
INSERT INTO SOFER (SOFER_ID, NUME, PRENUME, DATA_NASTERE, DATA_ANGAJARE, SALARIU) VALUES (1, 'Popescu', 'Ion', DATE '1985-05-12', DATE '2015-03-01', 3500.50);
INSERT INTO SOFER (SOFER_ID, NUME, PRENUME, DATA_NASTERE, DATA_ANGAJARE, SALARIU) VALUES (2, 'Ionescu', 'Mihai', DATE '1990-08-25', DATE '2017-07-15', 4000.75);
INSERT INTO SOFER (SOFER_ID, NUME, PRENUME, DATA_NASTERE, DATA_ANGAJARE, SALARIU) VALUES (3, 'Georgescu', 'Marian', DATE '1982-02-11', DATE '2013-10-10', 3700.20);
INSERT INTO SOFER (SOFER_ID, NUME, PRENUME, DATA_NASTERE, DATA_ANGAJARE, SALARIU) VALUES (4, 'Vasilescu', 'Andrei', DATE '1978-11-30', DATE '2010-05-22', 4500.00);
INSERT INTO SOFER (SOFER_ID, NUME, PRENUME, DATA_NASTERE, DATA_ANGAJARE, SALARIU) VALUES (5, 'Stan', 'Cristian', DATE '1995-06-19', DATE '2019-01-05', 3200.30);
INSERT INTO SOFER (SOFER_ID, NUME, PRENUME, DATA_NASTERE, DATA_ANGAJARE, SALARIU) VALUES (6, 'Radu', 'Florin', DATE '1988-03-27', DATE '2014-08-12', 3800.60);

-- Inserturi VEHICUL
INSERT INTO VEHICUL (VEHICUL_ID, MARCA, MODEL, NR_KILOMETRI, AN_FABRICATIE, CAPACITATE_REZERVOR) VALUES (1, 'Mercedes', 'Actros', 120000, 2018, 400);
INSERT INTO VEHICUL (VEHICUL_ID, MARCA, MODEL, NR_KILOMETRI, AN_FABRICATIE, CAPACITATE_REZERVOR) VALUES (2, 'Volvo', 'FH16', 140000, 2017, 500);
INSERT INTO VEHICUL (VEHICUL_ID, MARCA, MODEL, NR_KILOMETRI, AN_FABRICATIE, CAPACITATE_REZERVOR) VALUES (3, 'Scania', 'R500', 110000, 2019, 450);
INSERT INTO VEHICUL (VEHICUL_ID, MARCA, MODEL, NR_KILOMETRI, AN_FABRICATIE, CAPACITATE_REZERVOR) VALUES (4, 'DAF', 'XF', 160000, 2016, 550);
INSERT INTO VEHICUL (VEHICUL_ID, MARCA, MODEL, NR_KILOMETRI, AN_FABRICATIE, CAPACITATE_REZERVOR) VALUES (5, 'Iveco', 'Stralis', 130000, 2015, 400);
INSERT INTO VEHICUL (VEHICUL_ID, MARCA, MODEL, NR_KILOMETRI, AN_FABRICATIE, CAPACITATE_REZERVOR) VALUES (6, 'MAN', 'TGX', 100000, 2020, 480);

-- Inserturi AUTOCAR
INSERT INTO AUTOCAR (VEHICUL_ID, NR_LOCURI, SPARTIU_BAGAJE, DOTARI) VALUES (1, 50, 15.50, 'Aer conditionat, WiFi');
INSERT INTO AUTOCAR (VEHICUL_ID, NR_LOCURI, SPARTIU_BAGAJE, DOTARI) VALUES (2, 55, 18.00, 'Aer conditionat, Priza USB');
INSERT INTO AUTOCAR (VEHICUL_ID, NR_LOCURI, SPARTIU_BAGAJE, DOTARI) VALUES (3, 45, 12.00, 'WiFi, TV');

-- Inserturi TIR
INSERT INTO TIR (VEHICUL_ID, CAPACITATE_CILINDRICA, GREUTATE_MAXIMA, TIP_TRACTIUNE, NR_AXE) VALUES (4, 12500, 21.50, '6x4', 4);
INSERT INTO TIR (VEHICUL_ID, CAPACITATE_CILINDRICA, GREUTATE_MAXIMA, TIP_TRACTIUNE, NR_AXE) VALUES (5, 13500, 23.00, '4x2', 3);
INSERT INTO TIR (VEHICUL_ID, CAPACITATE_CILINDRICA, GREUTATE_MAXIMA, TIP_TRACTIUNE, NR_AXE) VALUES (6, 14000, 24.50, '6x2', 4);

-- Inserturi CLIENT
INSERT INTO CLIENT (CLIENT_ID, NUME, DESCRIERE, TIP_CLIENT, NR_TELEFON, EMAIL, JUDET, ORAS) VALUES (1, 'SC Transport SRL', 'Firma transport', 'Firma', '0712345678', 'contact@transport.ro', 'Bucuresti', 'Bucuresti');
INSERT INTO CLIENT (CLIENT_ID, NUME, DESCRIERE, TIP_CLIENT, NR_TELEFON, EMAIL, JUDET, ORAS) VALUES (2, 'Popescu Andrei', 'Client individual', 'Persoana fizica', '0721345678', 'andrei.popescu@gmail.com', 'Cluj', 'Cluj-Napoca');
INSERT INTO CLIENT (CLIENT_ID, NUME, DESCRIERE, TIP_CLIENT, NR_TELEFON, EMAIL, JUDET, ORAS) VALUES (3, 'SC Marfa SRL', 'Firma transport marfa', 'Firma', '0732345678', 'contact@marfa.ro', 'Iasi', 'Iasi');
INSERT INTO CLIENT (CLIENT_ID, NUME, DESCRIERE, TIP_CLIENT, NR_TELEFON, EMAIL, JUDET, ORAS) VALUES (4, 'Ionescu Maria', 'Client individual', 'Persoana fizica', '0742345678', 'maria.ionescu@yahoo.com', 'Constanta', 'Constanta');
INSERT INTO CLIENT (CLIENT_ID, NUME, DESCRIERE, TIP_CLIENT, NR_TELEFON, EMAIL, JUDET, ORAS) VALUES (5, 'SC Persoane SRL', 'Firma transport persoane', 'Firma', '0752345678', 'contact@persoane.ro', 'Brasov', 'Brasov');
INSERT INTO CLIENT (CLIENT_ID, NUME, DESCRIERE, TIP_CLIENT, NR_TELEFON, EMAIL, JUDET, ORAS) VALUES (6, 'Dumitrescu Ioana', 'Client individual', 'Persoana fizica', '0762345678', 'ioana.dumitrescu@hotmail.com', 'Timis', 'Timisoara');

-- Inserturi MENTENANTA
INSERT INTO MENTENANTA (MENTENANTA_ID, VEHICUL_ID, TIP_MENTENANTA, DESCRIERE, COST, DATA_ORA_START, DATA_ORA_END) VALUES (1, 1, 'Reparatie motor', 'Schimbare piese motor', 1500.50, TO_TIMESTAMP('2024-01-05 08:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2024-01-05 18:00:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO MENTENANTA (MENTENANTA_ID, VEHICUL_ID, TIP_MENTENANTA, DESCRIERE, COST, DATA_ORA_START, DATA_ORA_END) VALUES (2, 2, 'Verificare tehnica', 'Verificare tehnica periodica', 300.75, TO_TIMESTAMP('2024-01-10 09:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2024-01-10 12:00:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO MENTENANTA (MENTENANTA_ID, VEHICUL_ID, TIP_MENTENANTA, DESCRIERE, COST, DATA_ORA_START, DATA_ORA_END) VALUES (3, 3, 'Schimb ulei', 'Schimbare ulei motor', 200.00, TO_TIMESTAMP('2024-02-01 10:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2024-02-01 11:30:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO MENTENANTA (MENTENANTA_ID, VEHICUL_ID, TIP_MENTENANTA, DESCRIERE, COST, DATA_ORA_START, DATA_ORA_END) VALUES (4, 4, 'Reparatie cutie viteze', 'Inlocuire componente defecte', 2500.25, TO_TIMESTAMP('2024-03-15 07:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2024-03-15 19:00:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO MENTENANTA (MENTENANTA_ID, VEHICUL_ID, TIP_MENTENANTA, DESCRIERE, COST, DATA_ORA_START, DATA_ORA_END) VALUES (5, 5, 'Verificare frane', 'Testare si inlocuire placute frana', 400.00, TO_TIMESTAMP('2024-04-20 08:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2024-04-20 11:00:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO MENTENANTA (MENTENANTA_ID, VEHICUL_ID, TIP_MENTENANTA, DESCRIERE, COST, DATA_ORA_START, DATA_ORA_END) VALUES (6, 6, 'Inlocuire anvelope', 'Montare anvelope noi', 800.50, TO_TIMESTAMP('2024-05-25 09:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2024-05-25 14:00:00', 'YYYY-MM-DD HH24:MI:SS'));

-- Inserturi ACCIDENT (1 = DA, 0 = NU)
INSERT INTO ACCIDENT (ACCIDENT_ID, VEHICUL_ID, DESCRIERE, COST_DAUNE, DATA_ORA, LOC, GRAVITATE, AMIABIL) VALUES (1, 1, 'Coliziune usoara', 2000.50, TO_TIMESTAMP('2023-12-01 14:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'Bucuresti', 'Mica', 1);
INSERT INTO ACCIDENT (ACCIDENT_ID, VEHICUL_ID, DESCRIERE, COST_DAUNE, DATA_ORA, LOC, GRAVITATE, AMIABIL) VALUES (2, 2, 'Coliziune majora', 15000.00, TO_TIMESTAMP('2023-11-15 08:30:00', 'YYYY-MM-DD HH24:MI:SS'), 'Cluj-Napoca', 'Mare', 0);
INSERT INTO ACCIDENT (ACCIDENT_ID, VEHICUL_ID, DESCRIERE, COST_DAUNE, DATA_ORA, LOC, GRAVITATE, AMIABIL) VALUES (3, 3, 'Lovire gard', 500.00, TO_TIMESTAMP('2023-10-20 16:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'Timisoara', 'Mica', 1);
INSERT INTO ACCIDENT (ACCIDENT_ID, VEHICUL_ID, DESCRIERE, COST_DAUNE, DATA_ORA, LOC, GRAVITATE, AMIABIL) VALUES (4, 4, 'Rasturnare', 20000.00, TO_TIMESTAMP('2023-09-05 13:15:00', 'YYYY-MM-DD HH24:MI:SS'), 'Iasi', 'Critica', 0);
INSERT INTO ACCIDENT (ACCIDENT_ID, VEHICUL_ID, DESCRIERE, COST_DAUNE, DATA_ORA, LOC, GRAVITATE, AMIABIL) VALUES (5, 5, 'Avarii multiple', 12000.75, TO_TIMESTAMP('2023-08-25 10:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'Constanta', 'Mare', 0);
INSERT INTO ACCIDENT (ACCIDENT_ID, VEHICUL_ID, DESCRIERE, COST_DAUNE, DATA_ORA, LOC, GRAVITATE, AMIABIL) VALUES (6, 6, 'Coliziune spate', 3000.00, TO_TIMESTAMP('2023-07-18 17:45:00', 'YYYY-MM-DD HH24:MI:SS'), 'Oradea', 'Mica', 1);

-- Inserturi ALIMENTARE
INSERT INTO ALIMENTARE (ALIMENTARE_ID, VEHICUL_ID, LOC_ALIMENTARE, TIP_COMBUSTIBIL, CANTIATE_COMBUSTIBIL, DATA_ORA_ALIMENTARE, COST, BENZINARIE) VALUES (1, 1, 'Bucuresti', 'Motorina', 120.50, TO_TIMESTAMP('2024-01-02 10:00:00', 'YYYY-MM-DD HH24:MI:SS'), 20.00, 'OMV');
INSERT INTO ALIMENTARE (ALIMENTARE_ID, VEHICUL_ID, LOC_ALIMENTARE, TIP_COMBUSTIBIL, CANTIATE_COMBUSTIBIL, DATA_ORA_ALIMENTARE, COST, BENZINARIE) VALUES (2, 2, 'Cluj-Napoca', 'Motorina', 180.75, TO_TIMESTAMP('2024-01-10 09:30:00', 'YYYY-MM-DD HH24:MI:SS'), 30.00, 'Rompetrol');
INSERT INTO ALIMENTARE (ALIMENTARE_ID, VEHICUL_ID, LOC_ALIMENTARE, TIP_COMBUSTIBIL, CANTIATE_COMBUSTIBIL, DATA_ORA_ALIMENTARE, COST, BENZINARIE) VALUES (3, 3, 'Timisoara', 'Motorina', 150.00, TO_TIMESTAMP('2024-01-15 11:00:00', 'YYYY-MM-DD HH24:MI:SS'), 40.00, 'Petrom');
INSERT INTO ALIMENTARE (ALIMENTARE_ID, VEHICUL_ID, LOC_ALIMENTARE, TIP_COMBUSTIBIL, CANTIATE_COMBUSTIBIL, DATA_ORA_ALIMENTARE, COST, BENZINARIE) VALUES (4, 4, 'Iasi', 'Motorina', 220.30, TO_TIMESTAMP('2024-01-20 13:00:00', 'YYYY-MM-DD HH24:MI:SS'), 50.00, 'Lukoil');
INSERT INTO ALIMENTARE (ALIMENTARE_ID, VEHICUL_ID, LOC_ALIMENTARE, TIP_COMBUSTIBIL, CANTIATE_COMBUSTIBIL, DATA_ORA_ALIMENTARE, COST, BENZINARIE) VALUES (5, 5, 'Constanta', 'Motorina', 190.50, TO_TIMESTAMP('2024-01-25 14:30:00', 'YYYY-MM-DD HH24:MI:SS'), 60.00, 'MOL');
INSERT INTO ALIMENTARE (ALIMENTARE_ID, VEHICUL_ID, LOC_ALIMENTARE, TIP_COMBUSTIBIL, CANTIATE_COMBUSTIBIL, DATA_ORA_ALIMENTARE, COST, BENZINARIE) VALUES (6, 6, 'Oradea', 'Motorina', 160.00, TO_TIMESTAMP('2024-01-30 16:00:00', 'YYYY-MM-DD HH24:MI:SS'), 70.00, 'Shell');

-- Inserturi CURSA
INSERT INTO CURSA (CURSA_ID, VEHICUL_ID, LOC_PLECARE, LOC_SOSIRE, DATA_ORA_PLECARE, DATA_ORA_SOSIRE, COST_TOTAL) VALUES (1, 1, 'Bucuresti', 'Cluj-Napoca', TO_TIMESTAMP('2024-02-01 08:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2024-02-01 16:00:00', 'YYYY-MM-DD HH24:MI:SS'), 1200.50);
INSERT INTO CURSA (CURSA_ID, VEHICUL_ID, LOC_PLECARE, LOC_SOSIRE, DATA_ORA_PLECARE, DATA_ORA_SOSIRE, COST_TOTAL) VALUES (2, 2, 'Cluj-Napoca', 'Timisoara', TO_TIMESTAMP('2024-02-05 09:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2024-02-05 13:30:00', 'YYYY-MM-DD HH24:MI:SS'), 900.75);
INSERT INTO CURSA (CURSA_ID, VEHICUL_ID, LOC_PLECARE, LOC_SOSIRE, DATA_ORA_PLECARE, DATA_ORA_SOSIRE, COST_TOTAL) VALUES (3, 3, 'Timisoara', 'Iasi', TO_TIMESTAMP('2024-02-10 07:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2024-02-10 18:00:00', 'YYYY-MM-DD HH24:MI:SS'), 1500.00);
INSERT INTO CURSA (CURSA_ID, VEHICUL_ID, LOC_PLECARE, LOC_SOSIRE, DATA_ORA_PLECARE, DATA_ORA_SOSIRE, COST_TOTAL) VALUES (4, 4, 'Iasi', 'Brasov', TO_TIMESTAMP('2024-02-15 08:30:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2024-02-15 14:30:00', 'YYYY-MM-DD HH24:MI:SS'), 1100.25);
INSERT INTO CURSA (CURSA_ID, VEHICUL_ID, LOC_PLECARE, LOC_SOSIRE, DATA_ORA_PLECARE, DATA_ORA_SOSIRE, COST_TOTAL) VALUES (5, 5, 'Brasov', 'Constanta', TO_TIMESTAMP('2024-02-20 10:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2024-02-20 17:00:00', 'YYYY-MM-DD HH24:MI:SS'), 1300.60);
INSERT INTO CURSA (CURSA_ID, VEHICUL_ID, LOC_PLECARE, LOC_SOSIRE, DATA_ORA_PLECARE, DATA_ORA_SOSIRE, COST_TOTAL) VALUES (6, 6, 'Constanta', 'Bucuresti', TO_TIMESTAMP('2024-02-25 06:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2024-02-25 10:30:00', 'YYYY-MM-DD HH24:MI:SS'), 800.00);

-- Inserturi TRANSPORT_MARFA
INSERT INTO TRANSPORT_MARFA (CURSA_ID, TIP_MARFA, GREUTATE_MARFA, VOLUM_MARFA, CONDITII_SPECIALE, ASIGURARE_MARFA) VALUES (1, 'Electrocasnice', 1500.00, 25.50, 'Fragile', 50.75);
INSERT INTO TRANSPORT_MARFA (CURSA_ID, TIP_MARFA, GREUTATE_MARFA, VOLUM_MARFA, CONDITII_SPECIALE, ASIGURARE_MARFA) VALUES (2, 'MobilÄƒ', 2000.00, 35.00, 'N/A', 70.00);
INSERT INTO TRANSPORT_MARFA (CURSA_ID, TIP_MARFA, GREUTATE_MARFA, VOLUM_MARFA, CONDITII_SPECIALE, ASIGURARE_MARFA) VALUES (3, 'Automobile', 3000.00, 50.00, 'Special care for tires', 100.00);

-- Inserturi TRANSPORT_PERSOANE
INSERT INTO TRANSPORT_PERSOANE (CURSA_ID, NR_PASAGERI, GHID_TURISTIC) VALUES (4, 40, 0);
INSERT INTO TRANSPORT_PERSOANE (CURSA_ID, NR_PASAGERI, GHID_TURISTIC) VALUES (5, 20, 1);
INSERT INTO TRANSPORT_PERSOANE (CURSA_ID, NR_PASAGERI, GHID_TURISTIC) VALUES (6, 25, 0);

-- Inserturi SOFER_VEHICUL
INSERT INTO SOFER_VEHICUL (SOFER_VEHICUL_ID, VEHICUL_ID, SOFER_ID, DATA_ORA_START, DATA_ORA_END) VALUES (1, 1, 1, TO_TIMESTAMP('2025-01-15 10:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2025-01-15 14:00:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO SOFER_VEHICUL (SOFER_VEHICUL_ID, VEHICUL_ID, SOFER_ID, DATA_ORA_START, DATA_ORA_END) VALUES (2, 2, 2, TO_TIMESTAMP('2025-01-16 08:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2025-01-16 12:00:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO SOFER_VEHICUL (SOFER_VEHICUL_ID, VEHICUL_ID, SOFER_ID, DATA_ORA_START, DATA_ORA_END) VALUES (3, 3, 3, TO_TIMESTAMP('2025-01-17 09:30:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2025-01-17 13:00:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO SOFER_VEHICUL (SOFER_VEHICUL_ID, VEHICUL_ID, SOFER_ID, DATA_ORA_START, DATA_ORA_END) VALUES (4, 4, 4, TO_TIMESTAMP('2025-01-18 11:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2025-01-18 15:30:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO SOFER_VEHICUL (SOFER_VEHICUL_ID, VEHICUL_ID, SOFER_ID, DATA_ORA_START, DATA_ORA_END) VALUES (5, 5, 5, TO_TIMESTAMP('2025-01-19 07:45:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2025-01-19 11:15:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO SOFER_VEHICUL (SOFER_VEHICUL_ID, VEHICUL_ID, SOFER_ID, DATA_ORA_START, DATA_ORA_END) VALUES (6, 6, 6, TO_TIMESTAMP('2025-01-20 13:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2025-01-20 14:30:00', 'YYYY-MM-DD HH24:MI:SS'));

-- Inserturi CLIENT_CURSA
INSERT INTO CLIENT_CURSA (CLIENT_ID, CURSA_ID) VALUES (1, 1);
INSERT INTO CLIENT_CURSA (CLIENT_ID, CURSA_ID) VALUES (2, 2);
INSERT INTO CLIENT_CURSA (CLIENT_ID, CURSA_ID) VALUES (3, 3);
INSERT INTO CLIENT_CURSA (CLIENT_ID, CURSA_ID) VALUES (4, 4);
INSERT INTO CLIENT_CURSA (CLIENT_ID, CURSA_ID) VALUES (5, 5);
INSERT INTO CLIENT_CURSA (CLIENT_ID, CURSA_ID) VALUES (6, 6);

COMMIT;

-- cerere cu having, capitolul 3d
SELECT C.LOC_PLECARE,
       SUM(C.COST_TOTAL)   AS "COST TOTAL PER LOCATIE",
       SUM(TP.NR_PASAGERI) AS "NR TOTAL PASAGERI PER LOCATIE"
FROM CURSA C
         JOIN TRANSPORT_PERSOANE TP on C.CURSA_ID = TP.CURSA_ID
HAVING SUM(TP.NR_PASAGERI) > 10
group by C.LOC_PLECARE;

-- cerere cu informatii, capitolul 3c
SELECT M.TIP_MENTENANTA,
       M.DESCRIERE,
       M.COST,
       V.MODEL,
       V.MARCA,
       V.NR_KILOMETRI,
       CASE
           WHEN A2.VEHICUL_ID IS NOT NULL THEN 'Autocar'
           WHEN T.VEHICUL_ID IS NOT NULL THEN 'TIR'
           END AS TIP_VEHICUL
FROM MENTENANTA M
         JOIN VEHICUL V
              on M.VEHICUL_ID = V.VEHICUL_ID
         LEFT JOIN AUTOCAR A2 on V.VEHICUL_ID = A2.VEHICUL_ID
         LEFT JOIN TIR T on V.VEHICUL_ID = T.VEHICUL_ID
WHERE V.MARCA = 'Mercedes' AND M.COST >= 300;

-- vizualizari, capitolul 3f

--vizualizare compusa

CREATE OR REPLACE VIEW V_FLOTA_TIRURI AS
SELECT
    V.VEHICUL_ID,
    V.MARCA,
    V.MODEL,
    V.NR_KILOMETRI,
    T.CAPACITATE_CILINDRICA,
    T.GREUTATE_MAXIMA,
    T.NR_AXE
FROM VEHICUL V
JOIN TIR T ON V.VEHICUL_ID = T.VEHICUL_ID;

-- lmd

UPDATE V_FLOTA_TIRURI SET GREUTATE_MAXIMA = 25.00 WHERE VEHICUL_ID = 4;
SELECT * FROM V_FLOTA_TIRURI;

--vizualizare complexa

-- Aceasta calculeaza costurile totale de mentenanta si numarul de incidente pentru fiecare vehicul.
-- NU permite operatii LMD deoarece contine functii de grup (SUM, COUNT).

CREATE OR REPLACE VIEW V_RAPORT_COSTURI_VEHICUL AS
SELECT
    V.MARCA || ' ' || V.MODEL AS DENUMIRE_VEHICUL,
    V.AN_FABRICATIE,
    COUNT(DISTINCT M.MENTENANTA_ID) AS NR_INTRETINERI,
    NVL(SUM(M.COST), 0) AS COST_TOTAL_MENTENANTA,
    COUNT(DISTINCT A.ACCIDENT_ID) AS NR_ACCIDENTE,
    NVL(SUM(A.COST_DAUNE), 0) AS COST_TOTAL_ACCIDENTE,
    (NVL(SUM(M.COST), 0) + NVL(SUM(A.COST_DAUNE), 0)) AS COST_TOTAL_GENERAL
FROM VEHICUL V
LEFT JOIN MENTENANTA M ON V.VEHICUL_ID = M.VEHICUL_ID
LEFT JOIN ACCIDENT A ON V.VEHICUL_ID = A.VEHICUL_ID
GROUP BY V.MARCA, V.MODEL, V.AN_FABRICATIE;